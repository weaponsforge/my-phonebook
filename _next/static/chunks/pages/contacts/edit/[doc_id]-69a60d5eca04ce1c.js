(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[18],{7346:function(e,t,i){"use strict";var l=i(4836);t.Z=void 0;var n=l(i(4938)),a=i(5893),r=(0,n.default)([(0,a.jsx)("path",{d:"M12 4c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8zm5 11.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z",opacity:".3"},"0"),(0,a.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"},"1")],"CancelTwoTone");t.Z=r},8192:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contacts/edit/[doc_id]",function(){return i(1513)}])},2012:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var l=i(5893),n=i(7294),a=i(9397),r=i(9820),o=i(4799),s=i(594);function c(e){let{message:t,closeHandler:i}=e,[c,u]=(0,n.useState)(!0),d=(e,t)=>{"clickaway"!==t&&(u(!1),i&&i())},p=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.Z,{color:"secondary",size:"small",onClick:d,children:"UNDO"}),(0,l.jsx)(o.Z,{size:"small","aria-label":"close",color:"inherit",onClick:d,children:(0,l.jsx)(s.Z,{fontSize:"small"})})]});return(0,l.jsx)("div",{children:(0,l.jsx)(r.Z,{open:c,autoHideDuration:6e3,onClose:d,message:t,action:p,sx:{maxWidth:600}})})}},8978:function(e,t,i){"use strict";var l=i(5893),n=i(7294),a=i(2092),r=i(5697),o=i.n(r),s=i(4799),c=i(1170),u=i(7346);let d={SEARCH:"search",CANCEL:"cancel"},p=["image/bmp","image/jpeg","image/jpg","image/png","image/gif","image/webp"];function f(e){let{fileDomID:t,hasFile:i=!1,errorCallback:r,clearFileCallback:o,setFileCallback:f,styles:h={}}=e,m=(0,n.useMemo)(()=>t,[t]),g=(0,a.C0)(m),v=(0,n.useRef)(),[x,C]=(0,n.useState)(i?d.CANCEL:d.SEARCH);(0,n.useEffect)(()=>{C(i?d.CANCEL:d.SEARCH)},[i]),(0,n.useEffect)(()=>{void 0!==m&&(0,a.cA)(m,{file:null,imgSrc:null})},[m]),(0,n.useEffect)(()=>{if((null==g?void 0:g.imgSrc)!==null)return()=>{URL.revokeObjectURL(null==g?void 0:g.imgSrc)}},[g]);let _=(0,n.useMemo)(()=>x===d.SEARCH?c.Z:u.Z,[x]),j=async e=>{if(e.target.files[0]){if(!p.includes(e.target.files[0].type)){r("File type not supported.");return}C(d.CANCEL),f&&f(e.target.files[0].name),(0,a.cA)(t,{file:e.target.files[0],imgSrc:URL.createObjectURL(e.target.files[0])})}},y=e=>{e.preventDefault(),v.current.value=null,URL.revokeObjectURL(null==g?void 0:g.imgSrc),C(d.SEARCH),(0,a.cA)(t,{file:null,imgSrc:null}),o&&o()};return(0,l.jsxs)(s.Z,{color:"primary","aria-label":"upload picture",component:"label",sx:h,onClick:e=>{x===d.CANCEL&&y(e)},children:[(0,l.jsx)("input",{hidden:!0,accept:"image/*",type:"file",ref:v,onChange:j}),(0,l.jsx)(_,{sx:{color:"black"}})]})}f.propTypes={fileDomID:o().string.isRequired,hasFile:o().bool,errorCallback:o().func.isRequired,clearFileCallback:o().func,setFileCallback:o().func,styles:o().object},t.Z=f},1018:function(e,t,i){"use strict";i.d(t,{C_:function(){return r},kX:function(){return o},vJ:function(){return a}});var l=i(9825),n=i(6650);let a=async function(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=(0,n.iH)(l.tO,"".concat(e,"/").concat(i));try{await (0,n.KV)(r,t,{customMetadata:a})}catch(e){throw Error(e)}return await (0,n.Jt)(r)},r=async e=>{let{pathToStorageDirectory:t,pathToStorageFile:i,fileName:a,allowMissingError:r=!1}=e,o=null!=i?i:"".concat(t,"/").concat(a),s=(0,n.iH)(l.tO,"".concat(o));if(!r)return await (0,n.oq)(s);try{let e=await (0,n.oq)(s);return e}catch(e){return!0}},o=async e=>{let t=(0,n.iH)(l.tO,e);return await (0,n.Br)(t)}},1513:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return Z}});var l=i(5893),n=i(1163),a=i(7294),r=i(2092),o=i(7488),s=i(1018),c=i(7357),u=i(1987),d=i(3972),p=i(7952),f=i(2715),h=i(9397),m=i(6489),g=i(8534),v=i(5077),x=i(2012),C=i(8978);let _="savedPhotoBlob",j={sorting:"",first_name:"",middle_name:"",last_name:"",phone_number:"",email_address:"",profile_picture_url:""},y="picturefile",b=()=>{var e,t,i,g,b;let[Z,E]=(0,a.useState)(!1),[S,k]=(0,a.useState)(null),[w,N]=(0,a.useState)(!1),[R,A]=(0,a.useState)(!1),L=(0,n.useRouter)(),{doc_id:z}=L.query,{authUser:O}=(0,r.C0)("auth"),D=(0,r.ay)("contacts"),P=(0,r.C0)(y),H=D.data.filter(e=>e.doc_id===z)[0],[M,U]=(0,a.useState)(null!=H?H:j),{loading:F,error:q,photo:T}=function(e){let t=(0,r.ay)(_),[i,l]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=()=>{(0,r.Gt)(_,async()=>null,{deleteExistingData:!0})};return e(),()=>e()},[]),(0,a.useEffect)(()=>{if(i)return()=>{URL.revokeObjectURL(i)}},[i]),(0,a.useEffect)(()=>{if(null!==t.data&&!t.loading){let e=URL.createObjectURL(t.data);l(e)}},[t]),(0,a.useEffect)(()=>{e&&(0,r.Gt)(_,async()=>(0,s.kX)(e))},[e]);let n=(0,a.useMemo)(()=>{var e,i,l;return"boolean"==typeof t.error?"":null!==(l=null===(e=t.error)||void 0===e?void 0:null===(i=e.response)||void 0===i?void 0:i.data)&&void 0!==l?l:t.error.message},[t.error]);return{data:t.data,loading:t.loading,error:n,photo:i}}(""===M.profile_picture_url?null:M.profile_picture_url),J=(0,a.useMemo)(()=>{var e;return w?null!==(e=null==P?void 0:P.imgSrc)&&void 0!==e?e:"":T},[P,T,w]),W=(0,a.useMemo)(()=>""!==q?q:S||"",[S,q]);(0,a.useEffect)(()=>{R||(U(H),A(!0))},[H,R]);let G=e=>{let t=e.target.id,i=e.target.value,l={...M,[t]:i};U(l),JSON.stringify(l)===JSON.stringify(H)?E(!1):E(!0)},I=async()=>{var e,t,i,l;let n={...M,sorting:"".concat(M.first_name).concat(M.middle_name).concat(M.last_name).toUpperCase()};if(null==P?void 0:P.file)try{await (0,s.vJ)("photos/".concat(O.uid),P.file,"photo_".concat(z)),n.profile_picture_url="photos/".concat(O.uid,"/photo_").concat(z),(0,r.lC)("public_picture.".concat(JSON.stringify(n.profile_picture_url)))}catch(l){let i=null!==(t=null==l?void 0:null===(e=l.response)||void 0===e?void 0:e.data)&&void 0!==t?t:l.message;i.includes("storage/unauthorized")&&(i="Photo upload failed. Please verify that the photo you are uploading is less than 1 MB in file size. Only .jpg, .jpeg, .png, .gif, .bmp and .webp image file types are supported."),k(i);return}else w&&(n.profile_picture_url="");try{await o.q.updateDoc("users/".concat(O.uid,"/contacts/").concat(z),n),L.push("/contacts")}catch(t){let e=null!==(l=null==t?void 0:null===(i=t.response)||void 0===i?void 0:i.data)&&void 0!==l?l:t.message;e.includes("Missing or insufficient permissions")&&(e="Contact update failed. Please check your input."),k(e)}},X=async()=>{try{await Promise.all([o.q.deleteDoc("users/".concat(O.uid,"/contacts/").concat(z)),(0,s.C_)({pathToStorageDirectory:"photos/".concat(O.uid),fileName:"photo_".concat(z),allowMissingError:!0})]),U(j),L.push("/contacts")}catch(i){var e,t;k(null!==(t=null==i?void 0:null===(e=i.response)||void 0===e?void 0:e.data)&&void 0!==t?t:i.message)}};return(0,l.jsxs)(v.Z,{children:[(0,l.jsx)(c.Z,{sx:{flex:"1",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:"100%"},children:(0,l.jsxs)(u.Z,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"10px",alignItems:"center",padding:"30px",borderRadius:"20px",backgroundColor:"inherit",backdropFilter:"contrast(120%)"},children:[(0,l.jsx)(d.Z,{variant:"h5",sx:{gridColumn:"1/-1"},children:"edit Contact"}),(0,l.jsxs)(c.Z,{sx:{aspectRatio:"1",gridColumn:"1/-1",position:"relative"},children:[(0,l.jsx)(p.Z,{src:J,alt:"profile_picture_url",sx:e=>({width:"342px",height:"342px",[e.breakpoints.down("400")]:{width:"100%",height:"100%"}}),children:w?null:F||""!==M.profile_picture_url?(0,l.jsx)(m.Z,{size:24,color:"info"}):null}),(0,l.jsx)(C.Z,{fileDomID:y,styles:{position:"absolute",bottom:"0",right:"0"},errorCallback:e=>k(e),clearFileCallback:()=>{w||(N(!0),E(!0))},setFileCallback:()=>{w||(N(!0),E(!0))},hasFile:""!==J})]}),(0,l.jsx)(d.Z,{variant:"h7",children:"First Name"}),(0,l.jsx)(f.Z,{id:"first_name",size:"small",inputProps:{style:{height:"20px"}},value:null!==(e=null==M?void 0:M.first_name)&&void 0!==e?e:"",onChange:G}),(0,l.jsx)(d.Z,{variant:"h7",children:"Middle Name"}),(0,l.jsx)(f.Z,{id:"middle_name",size:"small",inputProps:{style:{height:"20px"}},value:null!==(t=null==M?void 0:M.middle_name)&&void 0!==t?t:"",onChange:G}),(0,l.jsx)(d.Z,{variant:"h7",children:"Last Name"}),(0,l.jsx)(f.Z,{id:"last_name",size:"small",inputProps:{style:{height:"20px"}},value:null!==(i=null==M?void 0:M.last_name)&&void 0!==i?i:"",onChange:G}),(0,l.jsx)(d.Z,{variant:"h7",children:"Email Address"}),(0,l.jsx)(f.Z,{id:"email_address",size:"small",inputProps:{style:{height:"20px"}},value:null!==(g=null==M?void 0:M.email_address)&&void 0!==g?g:"",onChange:G}),(0,l.jsx)(d.Z,{variant:"h7",children:"Phone Number"}),(0,l.jsx)(f.Z,{id:"phone_number",size:"small",inputProps:{style:{height:"20px"}},value:null!==(b=null==M?void 0:M.phone_number)&&void 0!==b?b:"",onChange:G}),Z?(0,l.jsx)(h.Z,{variant:"contained",sx:{gridColumn:"1/-1",fontWeight:"bold"},onClick:I,children:"SAVE CHANGE"}):(0,l.jsx)(h.Z,{variant:"contained",disabled:!0,sx:{gridColumn:"1/-1",fontWeight:"bold"},children:"SAVE CHANGE"}),(0,l.jsx)(h.Z,{variant:"contained",fullWidth:!0,onClick:X,sx:{gridColumn:"1/-1",fontWeight:"bold"},children:"Delete"})]})}),W&&(0,l.jsx)(x.Z,{message:W,closeHandler:()=>k(null)})]})};var Z=(0,g.Z)(b)}},function(e){e.O(0,[540,101,548,77,456,774,888,179],function(){return e(e.s=8192)}),_N_E=e.O()}]);