(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{8719:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contacts",function(){return n(49)}])},8534:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var a=n(5893),r=n(7294),i=n(1163),l=n(9005),s=n(7357),c=n(3972),d=n(6489),o=n(8600),u=function(e){let{children:t}=e;return(0,a.jsx)(s.Z,{sx:{width:{sm:"600px"},backgroundColor:{xs:"none",sm:"rgba(255, 255, 255, 0.4)"},borderRadius:"8px",textAlign:"center",margin:"24px !important",padding:"24px",display:"grid",placeContent:"center"},children:t})},x=n(3367),p=function(e){let{authError:t}=e,n=(0,x.e6)("activeTheme");return(0,a.jsx)(o.Z,{children:(0,a.jsx)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",placeContent:"center",height:"100vh"},children:(0,a.jsxs)(u,{children:[(0,a.jsx)("span",{children:(0,a.jsx)(c.Z,{variant:"h6",color:"#000",children:"Loading..."})}),(0,a.jsx)("span",{children:(0,a.jsx)(d.Z,{color:"light"===n?"dark":"primary"})}),t&&(0,a.jsx)(c.Z,{variant:"label",color:"error",children:t})]})})})},h=function(e){return function(t){let n=(0,i.useRouter)(),{authLoading:s,authError:c,authUser:d}=(0,l.a)();(0,r.useEffect)(()=>{s||d||n.push("/login")},[d,s,n]);let o=()=>s?(0,a.jsx)(p,{}):d?(0,a.jsx)(e,{...t}):(0,a.jsx)(p,{authError:c});return(0,a.jsx)(o,{})}}},9361:function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var a=n(5893),r=n(8441);let i=()=>(0,a.jsx)(r.Z,{sx:{position:"fixed",width:"100vw"}})},49:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var a=n(5893),r=n(8534),i=n(8600),l=n(9361),s=n(7357),c=n(3232),d=n(7297),o=n(3972),u=n(2734),x=n(1987),p=n(7952);function h(){let e=(0,d.Z)(["(?<firstNameInitial>^[a-z])"]);return h=function(){return e},e}function m(){let e=(0,d.Z)(["(?<middleNameInitial>^[a-z])"]);return m=function(){return e},e}function f(){let e=(0,d.Z)(["(?<lastNameInitial>^[a-z])"]);return f=function(){return e},e}let g=(e,t,n)=>{var a,r,i;let l=(null!==(a=e.match(RegExp(String.raw(h()),"i")))&&void 0!==a?a:[""])[0],s=(null!==(r=t.match(RegExp(String.raw(m()),"i")))&&void 0!==r?r:[""])[0],c=(null!==(i=n.match(RegExp(String.raw(f()),"i")))&&void 0!==i?i:[""])[0];return"".concat(l).concat(s).concat(c)},v=e=>{let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return t%255},j=e=>{let{contact:t}=e,n=(0,u.Z)(),r=g(t.first_name,t.middle_name,t.last_name).toUpperCase(),i=v(r),l=e=>{e.stopPropagation(),(0,c.lC)("ui.phase"),(0,c.cA)("ui.phase.editContact",!0),(0,c.cA)("ui.activeContact",t)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(x.Z,{elevation:5,sx:{backgroundColor:"inherit",backdropFilter:"blur(2px)",display:{xs:"none",md:"grid"},gridTemplateColumns:"1fr 6fr",gridAutoRows:"1fr",padding:"15px",gap:"15px",alignItems:"center",borderRadius:"10px",width:"auto",maxWidth:"80vw","&:hover":{backdropFilter:"contrast(120%)"}},onClick:l,children:[(0,a.jsx)(p.Z,{sx:{backgroundColor:"hsla(".concat(i,",50%,80%,50%)"),border:"1px solid grey"},children:r}),(0,a.jsxs)(o.Z,{variant:"h8",sx:{color:n.palette.primary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.first_name," ",t.middle_name," ",t.last_name]})]}),(0,a.jsxs)(x.Z,{elevation:0,sx:{backgroundColor:"inherit",backdropFilter:"blur(2px)",display:{xs:"grid",md:"none"},gridTemplateColumns:"1fr 6fr",gridAutoRows:"1fr",padding:"15px",gap:"15px",alignItems:"center",borderRadius:"10px",width:"auto",maxWidth:"80vw","&:hover":{backdropFilter:"contrast(120%)"}},onClick:l,children:[(0,a.jsx)(p.Z,{sx:{backgroundColor:"hsla(".concat(i,",50%,80%,50%)"),border:"1px solid grey"},children:r}),(0,a.jsxs)(o.Z,{variant:"h8",sx:{color:n.palette.primary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.first_name," ",t.middle_name," ",t.last_name]})]})]})},C=e=>{let{content:t}=e,{group:n,contacts:r}=t;return(0,a.jsxs)(s.Z,{sx:{display:"grid",gridTemplateColumns:"40px 1fr",p:"25px",borderBottom:"1px dashed grey"},children:[(0,a.jsx)(o.Z,{variant:"h4",sx:{padding:"15px",paddingLeft:"0",aspectRatio:"1",position:"sticky",top:0},children:"misc"===n?"":n}),(0,a.jsx)(s.Z,{sx:{backgroundColor:"inherit",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",alignItems:"start",gap:"10px",flex:"1"},children:r.map((e,t)=>(0,a.jsx)(j,{contact:e},t))})]})};function _(){let e=(0,d.Z)(["(?<firstLetterChar>^[a-z])|"]);return _=function(){return e},e}let w=()=>{let{data:e,error:t}=(0,c.ay)("contacts"),n=[...null!=e?e:[]].reduce((e,t)=>{let n=t.first_name.match(RegExp(String.raw(_()),"i"))[0];return n?(e[n.toUpperCase()]||(e[n.toUpperCase()]=[]),e[n.toUpperCase()]=[...e[n.toUpperCase()],t]):(e.misc||(e.misc=[]),e.misc=[...e.misc,t]),e},{}),r=Object.entries(n);return(0,a.jsxs)(s.Z,{sx:{width:"100%",height:"100%"},children:[e&&r.map((e,t)=>(0,a.jsx)(C,{content:{group:e[0],contacts:e[1]}},t)),t&&(0,a.jsx)("div",{children:"Error"})]})};var Z=n(7294);let b={first_name:"Matching First Name",middle_name:"Matching Middle Name",last_name:"Matching Last Name",contact_no:"Matching Contact Number",contact_email:"Matching Contact Email"},y=e=>{let{content:t}=e,{group:n,contacts:r}=t;if(b[n])return(0,a.jsxs)(s.Z,{sx:{display:"grid",gridTemplateColumns:"1fr",padding:"20px",borderBottom:"1px dashed grey"},children:[(0,a.jsx)(o.Z,{variant:"h5",sx:{},children:b[n]}),(0,a.jsx)(s.Z,{sx:{backgroundColor:"inherit",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",alignItems:"start",gap:"10px",flex:"1"},children:r.map((e,t)=>(0,a.jsx)(j,{contact:e},t))})]})};function k(){let e=(0,d.Z)(["",""]);return k=function(){return e},e}let{Box:E}=n(4914),A=(e,t)=>{let n=[...t].reduce((t,n)=>{for(let[a,r]of Object.entries(n))RegExp(String.raw(k(),e),"i").test(r)&&(t[a]||(t[a]=[]),t[a]=[...t[a],n]);return t},{});return n},N=()=>{let e=(0,c.C0)("ui.search.searchKeyword"),t=(0,c.C0)("contacts.data"),n=A(e,t);delete n.doc_id,delete n.profile_picture_url,delete n.date_updated,delete n.date_created;let r=Object.entries(n);return(0,Z.useEffect)(()=>{if(1===r.length)for(let[,e]of r)(0,c.cA)("ui.activeContact",e[0]),(0,c.cA)("ui.phase.editContact",!0)},[r]),(0,a.jsx)(E,{sx:{width:"100%",height:"100%"},children:(0,a.jsx)(E,{children:r.map((e,t)=>(0,a.jsx)(y,{content:{group:e[0],contacts:e[1]}},t))})})},S=()=>{let e=(0,c.C0)("ui.phase");return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.Z,{sx:{flex:6.8,minWidth:"500px",maxHeight:"100%",width:"100%",height:"100%",overflowY:"scroll",userSelect:"none","&::-webkit-scrollbar":{display:"none"}},children:(null==e?void 0:e.search)?(0,a.jsx)(N,{}):(0,a.jsx)(w,{})})})};var I=n(7488),R=n(9397),W=n(2715),z=n(2761);let F=()=>{let e=(0,c.C0)("ui.search.searchKeyword"),t=e=>{e.stopPropagation(),(0,c.cA)("ui.search.searchKeyword",e.target.value),(0,c.cA)("ui.phase",e=>({...e,createContact:!1,editContact:!1})),""===e.target.value?(0,c.cA)("ui.phase",e=>({...e,createContact:!1,editContact:!1,search:!1})):(0,c.cA)("ui.phase.search",!0)};return(0,a.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,a.jsx)(z.Z,{fontSize:"large",sx:{aspectRatio:1}}),(0,a.jsx)(W.Z,{fullWidth:!0,size:"small",variant:"outlined",value:null!=e?e:"",onChange:t,id:"searchField"})]})};var O=n(9005);let T=()=>{let e=(0,O.a)(),t=(0,c.C0)("ui.activeContact"),{editContact:n,createContact:r}=(0,c.C0)("ui.phase"),[i,l]=(0,Z.useState)(t),[d,u]=(0,Z.useState)(!1);(0,Z.useEffect)(()=>{l(t)},[t]);let x=e=>{let n=e.target.id,a=e.target.value,r={...i,[n]:a};l(r),JSON.stringify(r)===JSON.stringify(t)?u(!1):u(!0)},h=()=>{let a=e.authUser.uid;switch(!0){case n:{var s,c,d,o,x,p;let e={first_name:null!==(s=null==i?void 0:i.first_name)&&void 0!==s?s:"",middle_name:null!==(c=null==i?void 0:i.middle_name)&&void 0!==c?c:"",last_name:null!==(d=null==i?void 0:i.last_name)&&void 0!==d?d:"",phone_number:null!==(o=null==i?void 0:i.phone_number)&&void 0!==o?o:"",email_address:null!==(x=null==i?void 0:i.email_address)&&void 0!==x?x:"",profile_picture_url:null!==(p=null==i?void 0:i.profile_picture_url)&&void 0!==p?p:""},n=t.doc_id;I.q.updateDoc("users/".concat(a,"/contacts/").concat(n),e),u(!1);break}case r:I.q.createDoc("users/".concat(a,"/contacts/"),i),l(t)}};return(0,a.jsx)(s.Z,{sx:{display:"grid",gap:"10px",width:"100%",height:"auto"},children:(0,a.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",gap:"10px",alignItems:"center",width:"100%"},children:[(0,a.jsxs)(o.Z,{variant:"h4",sx:{alignSelf:"start"},children:[n&&"Edit Contact",r&&"Create Contact"]}),(0,a.jsx)(p.Z,{sx:{width:"50vw",maxWidth:"200px",maxHeight:"200px",height:"50vw",justifySelf:"center",gridColumn:"1/-1",border:"5px dashed gray",margin:"10px",src:"".concat(null==i?void 0:i.profile_picture_url)}}),(0,a.jsxs)(s.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",width:"100%"},children:[(0,a.jsx)(o.Z,{variant:"h8",children:"First Name :"}),(0,a.jsx)(W.Z,{id:"first_name",value:i.first_name,size:"small",sx:{width:"100%"},onChange:x})]}),(0,a.jsxs)(s.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",width:"100%"},children:[(0,a.jsx)(o.Z,{variant:"h8",children:"Middle Name :"}),(0,a.jsx)(W.Z,{id:"middle_name",value:i.middle_name,size:"small",sx:{width:"100%"},onChange:x})]}),(0,a.jsxs)(s.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",width:"100%"},children:[(0,a.jsx)(o.Z,{variant:"h8",children:"Last Name:"}),(0,a.jsx)(W.Z,{id:"last_name",value:i.last_name,size:"small",sx:{width:"100%"},onChange:x})]}),(0,a.jsxs)(s.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",width:"100%"},children:[(0,a.jsx)(o.Z,{variant:"h8",children:"Phone Number:"}),(0,a.jsx)(W.Z,{id:"phone_number",value:i.phone_number,size:"small",sx:{width:"100%"},onChange:x})]}),(0,a.jsxs)(s.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",width:"100%"},children:[(0,a.jsx)(o.Z,{variant:"h8",children:"Email Address:"}),(0,a.jsx)(W.Z,{id:"email_address",value:i.email_address,size:"small",sx:{width:"100%"},onChange:x})]}),(0,a.jsx)(R.Z,{variant:"contained",fullWidth:!0,disabled:!d,onClick:h,children:"Save"})]})})},U=()=>{let e=(0,c.C0)("ui.activeContact.doc_id"),t=(0,c.C0)("ui.phase"),n=()=>{(0,c.cA)("ui.phase.editContact",!1),(0,c.cA)("ui.phase.createContact",!0),(0,c.cA)("ui.activeContact",{doc_id:"",first_name:"",middle_name:"",last_name:"",phone_number:"",email_address:"",profile_picture_url:""})},r=()=>{I.q.deleteDoc("users/test/contacts/".concat(e)),(0,c.cA)("ui.activeContact",null),(0,c.cA)("ui.phase",null)};return(0,a.jsxs)(x.Z,{elevation:0,sx:{flex:3.14,display:"flex",flexDirection:"column",minWidth:"200px",zIndex:"50",backgroundColor:"inherit",padding:"20px",paddingBottom:"0",width:"100%",gap:"20px",overflowY:"scroll",userSelect:"none","&::-webkit-scrollbar":{display:"none"}},children:[(0,a.jsx)(F,{}),((null==t?void 0:t.editContact)||(null==t?void 0:t.createContact))&&(0,a.jsx)(T,{}),!(null==t?void 0:t.createContact)&&(0,a.jsx)(R.Z,{variant:"contained",onClick:n,children:(0,a.jsx)(o.Z,{children:"Create Contact"})}),(0,a.jsx)(R.Z,{variant:"contained",onClick:r,children:(0,a.jsx)(o.Z,{children:"Delete Contact"})})]})};var D=function(){let{loading:e}=(0,c.ay)("contacts");return(0,a.jsxs)(i.Z,{children:[e&&(0,a.jsx)(l.l,{}),(0,a.jsxs)(s.Z,{sx:{flex:1,display:"flex",flexWrap:"wrap",overflowY:"scroll",userSelect:"none","&::-webkit-scrollbar":{display:"none"}},children:[(0,a.jsx)(U,{}),(0,a.jsx)(S,{})]})]})},M=(0,r.Z)(function(){let e=(0,O.a)();(0,Z.useEffect)(()=>{I.q.subscribeCol("users/".concat(e.authUser.uid,"/contacts"),e=>{let t=[];e.forEach(e=>{t.push(e.data())}),(0,c.Gt)("contacts",()=>t)})},[e.authUser.uid]);let t=()=>{};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(D,{eventsHandler:t})})})}},function(e){e.O(0,[553,657,368,418,600,774,888,179],function(){return e(e.s=8719)}),_N_E=e.O()}]);